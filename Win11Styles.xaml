<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Windows 11 主色调 -->
    <Color x:Key="Win11PrimaryColor">#0078D4</Color>
    <Color x:Key="Win11SecondaryColor">#404040</Color>
    <Color x:Key="Win11AccentColor">#0078D4</Color>
    <Color x:Key="Win11BackgroundColor">#F3F3F3</Color>
    <Color x:Key="Win11SurfaceColor">#FAFAFA</Color>
    <Color x:Key="Win11CardColor">#FFFFFF</Color>
    <Color x:Key="Win11BorderColor">#E1E1E1</Color>
    <Color x:Key="Win11TextPrimaryColor">#323130</Color>
    <Color x:Key="Win11TextSecondaryColor">#605E5C</Color>
    <Color x:Key="Win11SuccessColor">#107C10</Color>
    <Color x:Key="Win11WarningColor">#FF8C00</Color>
    <Color x:Key="Win11ErrorColor">#D13438</Color>

    <!-- 从颜色创建画笔 -->
    <SolidColorBrush x:Key="Win11PrimaryBrush" Color="{StaticResource Win11PrimaryColor}" />
    <SolidColorBrush x:Key="Win11SecondaryBrush" Color="{StaticResource Win11SecondaryColor}" />
    <SolidColorBrush x:Key="Win11AccentBrush" Color="{StaticResource Win11AccentColor}" />
    <SolidColorBrush x:Key="Win11BackgroundBrush" Color="{StaticResource Win11BackgroundColor}" />
    <SolidColorBrush x:Key="Win11SurfaceBrush" Color="{StaticResource Win11SurfaceColor}" />
    <SolidColorBrush x:Key="Win11CardBrush" Color="{StaticResource Win11CardColor}" />
    <SolidColorBrush x:Key="Win11BorderBrush" Color="{StaticResource Win11BorderColor}" />
    <SolidColorBrush x:Key="Win11TextPrimaryBrush" Color="{StaticResource Win11TextPrimaryColor}" />
    <SolidColorBrush x:Key="Win11TextSecondaryBrush" Color="{StaticResource Win11TextSecondaryColor}" />
    <SolidColorBrush x:Key="Win11SuccessBrush" Color="{StaticResource Win11SuccessColor}" />
    <SolidColorBrush x:Key="Win11WarningBrush" Color="{StaticResource Win11WarningColor}" />
    <SolidColorBrush x:Key="Win11ErrorBrush" Color="{StaticResource Win11ErrorColor}" />

    <!-- 圆角值 -->
    <CornerRadius x:Key="Win11CornerRadius">8</CornerRadius>
    <CornerRadius x:Key="Win11SmallCornerRadius">4</CornerRadius>
    <CornerRadius x:Key="Win11LargeCornerRadius">12</CornerRadius>

    <!-- Windows 11 按钮样式 -->
    <Style x:Key="Win11ButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="{StaticResource Win11PrimaryBrush}" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="{DynamicResource CurrentConfigFontSize}" />
        <Setter Property="FontWeight" Value="SemiBold" />
        <Setter Property="Padding" Value="16,8" />
        <Setter Property="Margin" Value="5" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            CornerRadius="{StaticResource Win11CornerRadius}">
                        <ContentPresenter x:Name="ContentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#106EBE" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#0E5A9E" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="RootBorder" Property="Background" Value="#F3F2F1" />
                            <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="#A19F9D" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 次要按钮样式 -->
    <Style x:Key="Win11SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource Win11ButtonStyle}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            CornerRadius="{StaticResource Win11CornerRadius}">
                        <ContentPresenter x:Name="ContentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#F3F2F1" />
                            <Setter TargetName="RootBorder" Property="BorderBrush" Value="#8A8886" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#E1DFDD" />
                            <Setter TargetName="RootBorder" Property="BorderBrush" Value="#605E5C" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="RootBorder" Property="Background" Value="Transparent" />
                            <Setter TargetName="RootBorder" Property="BorderBrush" Value="#F3F2F1" />
                            <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="#A19F9D" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 危险按钮样式 -->
    <Style x:Key="Win11DangerButtonStyle" TargetType="Button" BasedOn="{StaticResource Win11ButtonStyle}">
        <Setter Property="Background" Value="{StaticResource Win11ErrorBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            CornerRadius="{StaticResource Win11CornerRadius}">
                        <ContentPresenter x:Name="ContentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#A4262C" />
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="RootBorder" Property="Background" Value="#8B1116" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="RootBorder" Property="Background" Value="#F3F2F1" />
                            <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="#A19F9D" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 卡片样式 -->
    <Style x:Key="Win11CardStyle" TargetType="Border">
        <Setter Property="Background" Value="{StaticResource Win11CardBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="CornerRadius" Value="{StaticResource Win11CornerRadius}" />
        <Setter Property="Padding" Value="16" />
        <Setter Property="Effect">
            <Setter.Value>
                <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="1" BlurRadius="8" Opacity="0.1" />
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 GroupBox 样式 -->
    <Style x:Key="Win11GroupBoxStyle" TargetType="GroupBox">
        <Setter Property="Background" Value="{StaticResource Win11CardBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="FontFamily" Value="Segoe UI Variable" />
        <Setter Property="FontSize" Value="16" />
        <Setter Property="FontWeight" Value="SemiBold" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="GroupBox">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{StaticResource Win11CornerRadius}"
                            Padding="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" 
                                    Background="{StaticResource Win11SurfaceBrush}"
                                    CornerRadius="{StaticResource Win11CornerRadius}"
                                    Margin="0"
                                    Padding="16,12">
                                <ContentPresenter ContentSource="Header" />
                            </Border>
                            <Border Grid.Row="1" Padding="16">
                                <ContentPresenter />
                            </Border>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 TextBlock 样式 -->
    <Style x:Key="Win11TitleStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="20" />
        <Setter Property="FontWeight" Value="SemiBold" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
    </Style>

    <Style x:Key="Win11SubtitleStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="16" />
        <Setter Property="FontWeight" Value="Medium" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
    </Style>

    <Style x:Key="Win11BodyStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="{DynamicResource CurrentConfigFontSize}" />
        <Setter Property="FontWeight" Value="Normal" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
    </Style>

    <Style x:Key="Win11CaptionStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="12" />
        <Setter Property="FontWeight" Value="Normal" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextSecondaryBrush}" />
    </Style>

    <!-- Windows 11 CheckBox 样式 -->
    <Style x:Key="Win11CheckBoxStyle" TargetType="CheckBox">
        <Setter Property="FontFamily" Value="Segoe UI Variable" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="CheckBox">
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="CheckBorder"
                                Width="18"
                                Height="18"
                                Background="{StaticResource Win11CardBrush}"
                                BorderBrush="{StaticResource Win11BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="{StaticResource Win11SmallCornerRadius}"
                                Margin="0,0,8,0">
                            <Path x:Name="CheckMark"
                                  Stroke="{StaticResource Win11PrimaryBrush}"
                                  StrokeThickness="2"
                                  Data="M 3,7 L 7,11 L 13,3"
                                  Visibility="Collapsed" />
                        </Border>
                        <ContentPresenter />
                    </StackPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="CheckBorder" Property="BorderBrush" Value="{StaticResource Win11PrimaryBrush}" />
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible" />
                            <Setter TargetName="CheckBorder" Property="Background" Value="{StaticResource Win11PrimaryBrush}" />
                            <Setter TargetName="CheckMark" Property="Stroke" Value="White" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="CheckBorder" Property="BorderBrush" Value="#F3F2F1" />
                            <Setter TargetName="CheckBorder" Property="Background" Value="#F3F2F1" />
                            <Setter TargetName="CheckMark" Property="Stroke" Value="#A19F9D" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 ScrollViewer 样式 -->
    <Style x:Key="Win11ScrollViewerStyle" TargetType="ScrollViewer">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ScrollViewer">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        
                        <ScrollContentPresenter Grid.Column="0" Grid.Row="0" />
                        
                        <ScrollBar Grid.Column="1" Grid.Row="0" 
                                   Name="PART_VerticalScrollBar" 
                                   Orientation="Vertical"
                                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                   Width="12"
                                   Margin="0,0,4,0">
                            <ScrollBar.Template>
                                <ControlTemplate TargetType="ScrollBar">
                                    <Grid>
                                        <Rectangle Fill="#F3F2F1" RadiusX="6" RadiusY="6" />
                                        <Track x:Name="PART_Track" IsDirectionReversed="True">
                                            <Track.DecreaseRepeatButton>
                                                <RepeatButton Command="ScrollBar.PageUpCommand" Opacity="0" />
                                            </Track.DecreaseRepeatButton>
                                            <Track.Thumb>
                                                <Thumb Background="#C8C6C4" Width="8" Margin="2" />
                                            </Track.Thumb>
                                            <Track.IncreaseRepeatButton>
                                                <RepeatButton Command="ScrollBar.PageDownCommand" Opacity="0" />
                                            </Track.IncreaseRepeatButton>
                                        </Track>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="PART_Track" Property="Thumb.Background" Value="#A19F9D" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ScrollBar.Template>
                        </ScrollBar>
                        
                        <ScrollBar Grid.Column="0" Grid.Row="1" 
                                   Name="PART_HorizontalScrollBar" 
                                   Orientation="Horizontal"
                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                   Height="12"
                                   Margin="0,4,0,0">
                            <ScrollBar.Template>
                                <ControlTemplate TargetType="ScrollBar">
                                    <Grid>
                                        <Rectangle Fill="#F3F2F1" RadiusX="6" RadiusY="6" />
                                        <Track x:Name="PART_Track" IsDirectionReversed="False">
                                            <Track.DecreaseRepeatButton>
                                                <RepeatButton Command="ScrollBar.PageLeftCommand" Opacity="0" />
                                            </Track.DecreaseRepeatButton>
                                            <Track.Thumb>
                                                <Thumb Background="#C8C6C4" Height="8" Margin="2" />
                                            </Track.Thumb>
                                            <Track.IncreaseRepeatButton>
                                                <RepeatButton Command="ScrollBar.PageRightCommand" Opacity="0" />
                                            </Track.IncreaseRepeatButton>
                                        </Track>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="PART_Track" Property="Thumb.Background" Value="#A19F9D" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ScrollBar.Template>
                        </ScrollBar>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 StatusBar 样式 -->
    <Style x:Key="Win11StatusBarStyle" TargetType="StatusBar">
        <Setter Property="Background" Value="{StaticResource Win11SurfaceBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="BorderThickness" Value="0,1,0,0" />
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="12" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Padding" Value="16,8" />
    </Style>

    <!-- Windows 11 Menu 样式 -->
    <Style x:Key="Win11MenuStyle" TargetType="Menu">
        <Setter Property="Background" Value="{StaticResource Win11SurfaceBrush}" />
        <Setter Property="BorderBrush" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="BorderThickness" Value="0,0,0,1" />
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Padding" Value="8,4" />
    </Style>

    <!-- Windows 11 MenuItem 样式 -->
    <Style x:Key="Win11MenuItemStyle" TargetType="MenuItem">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="FontFamily" Value="{DynamicResource CurrentConfigFontFamily}" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
        <Setter Property="Padding" Value="12,6" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="MenuItem">
                    <Border x:Name="Border" 
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            CornerRadius="{StaticResource Win11SmallCornerRadius}">
                        <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Padding}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="#E1DFDD" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Windows 11 Separator 样式 -->
    <Style x:Key="Win11SeparatorStyle" TargetType="Separator">
        <Setter Property="Background" Value="{StaticResource Win11BorderBrush}" />
        <Setter Property="Margin" Value="8,4" />
    </Style>

    <!-- Windows 11 StackPanel 样式 -->
    <Style x:Key="Win11StackPanelStyle" TargetType="StackPanel">
        <Setter Property="Margin" Value="0,8" />
    </Style>

    <!-- Windows 11 Grid 样式 -->
    <Style x:Key="Win11GridStyle" TargetType="Grid">
        <Setter Property="Margin" Value="0,8" />
    </Style>

    <!-- Windows 11 Window 样式 -->
    <Style x:Key="Win11WindowStyle" TargetType="Window">
        <Setter Property="Background" Value="{StaticResource Win11BackgroundBrush}" />
        <Setter Property="FontFamily" Value="Segoe UI Variable" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="Foreground" Value="{StaticResource Win11TextPrimaryBrush}" />
    </Style>
</ResourceDictionary>